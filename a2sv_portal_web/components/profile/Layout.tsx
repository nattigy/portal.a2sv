import { Box, Typography, Drawer, List, ListItem, ListItemButton, ListItemIcon, ListItemText, SvgIcon } from '@mui/material';
import React, { useState } from 'react'
import { WithChildren } from '../../types/common';
import CustomAppbar from '../common/Appbar';
import Link from 'next/link';
import { useRouter } from 'next/router';

interface LayoutProps extends WithChildren {

}

const drawerWidth = 300;

export default function ProfileLayout({ children }: LayoutProps) {
    const [mobileOpen, setMobileOpen] = useState(false);
    const router = useRouter();

    let container = undefined;

    if (typeof window !== "undefined") {
        container = window.document.body;
    }
    const handleDrawerToggle = () => {
        setMobileOpen(!mobileOpen);
    };

    const drawerItems = [
        {
            id: "1",
            title: "Profile",
            icon: (
                <>
                    <path d="M15.5 1C7.49165 1 1 7.49165 1 15.5C1 23.5084 7.49165 30 15.5 30C23.5084 30 30 23.5084 30 15.5C30 7.49165 23.5084 1 15.5 1Z" fill="white" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                    <path d="M4.29272 24.7025C4.29272 24.7025 7.52477 20.5758 15.4998 20.5758C23.4748 20.5758 26.7083 24.7025 26.7083 24.7025M15.4998 15.5008C16.6535 15.5008 17.7599 15.0425 18.5757 14.2267C19.3915 13.4109 19.8498 12.3045 19.8498 11.1508C19.8498 9.99709 19.3915 8.89065 18.5757 8.07487C17.7599 7.25908 16.6535 6.80078 15.4998 6.80078C14.3461 6.80078 13.2396 7.25908 12.4239 8.07487C11.6081 8.89065 11.1498 9.99709 11.1498 11.1508C11.1498 12.3045 11.6081 13.4109 12.4239 14.2267C13.2396 15.0425 14.3461 15.5008 15.4998 15.5008Z" fill="white" />
                    <path d="M4.29272 24.7025C4.29272 24.7025 7.52477 20.5758 15.4998 20.5758C23.4748 20.5758 26.7083 24.7025 26.7083 24.7025M15.4998 15.5008C16.6535 15.5008 17.7599 15.0425 18.5757 14.2267C19.3915 13.4109 19.8498 12.3045 19.8498 11.1508C19.8498 9.99709 19.3915 8.89065 18.5757 8.07487C17.7599 7.25908 16.6535 6.80078 15.4998 6.80078C14.3461 6.80078 13.2396 7.25908 12.4239 8.07487C11.6081 8.89065 11.1498 9.99709 11.1498 11.1508C11.1498 12.3045 11.6081 13.4109 12.4239 14.2267C13.2396 15.0425 14.3461 15.5008 15.4998 15.5008V15.5008Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                </>
            ),
            link: "/profile",
        },
        {
            id: "2",
            title: "Education",
            icon: (
                <>
                    <path d="M24.7778 22.4988L17 26.6063L9.22222 22.4988V18.1591L7 17V23.7189L17 29L27 23.7189V17L24.7778 18.1591V22.4988V22.4988Z" fill='currentColor' />
                    <path d="M16 0L0 8.22446V10.1883L16 19L29.7143 11.4472V17.7042H32V8.22446L16 0ZM27.4286 10.1139L25.1429 11.3727L16 16.4083L6.85714 11.3727L4.57143 10.1139L2.98721 9.24137L16 2.55242L29.0128 9.24137L27.4286 10.1139Z" fill='currentColor' />
                </>
            ),
            link: "/profile/education",
        },
        {
            id: "3",
            title: "SM Handles",
            icon: (
                <>
                    <path d="M19 20.3809C20.1046 20.3809 21 19.5476 21 18.5196C21 17.4916 20.1046 16.6582 19 16.6582C17.8954 16.6582 17 17.4916 17 18.5196C17 19.5476 17.8954 20.3809 19 20.3809Z" fill="currentColor" />
                    <path d="M5 7.35164C6.10457 7.35164 7 6.51828 7 5.49027C7 4.46227 6.10457 3.62891 5 3.62891C3.89543 3.62891 3 4.46227 3 5.49027C3 6.51828 3.89543 7.35164 5 7.35164Z" fill="currentColor" />
                    <path d="M25 27.8263C24.2089 27.8263 23.4355 27.608 22.7777 27.1989C22.1199 26.7899 21.6072 26.2085 21.3045 25.5282C21.0017 24.848 20.9225 24.0995 21.0769 23.3773C21.2312 22.6552 21.6122 21.9919 22.1716 21.4712C22.731 20.9506 23.4437 20.596 24.2196 20.4524C24.9956 20.3087 25.7998 20.3825 26.5307 20.6642C27.2616 20.946 27.8864 21.4232 28.3259 22.0354C28.7654 22.6476 29 23.3673 29 24.1036C28.9968 25.09 28.5744 26.0352 27.8249 26.7327C27.0755 27.4302 26.0599 27.8234 25 27.8263ZM25 22.2422C24.6044 22.2422 24.2178 22.3514 23.8889 22.5559C23.56 22.7605 23.3036 23.0512 23.1522 23.3913C23.0009 23.7314 22.9613 24.1057 23.0384 24.4667C23.1156 24.8278 23.3061 25.1595 23.5858 25.4198C23.8655 25.6801 24.2219 25.8574 24.6098 25.9292C24.9978 26.001 25.3999 25.9642 25.7654 25.8233C26.1308 25.6824 26.4432 25.4438 26.6629 25.1377C26.8827 24.8316 27 24.4717 27 24.1036C26.9984 23.6104 26.7872 23.1378 26.4125 22.789C26.0377 22.4403 25.5299 22.2437 25 22.2422Z" fill="currentColor" />
                    <path d="M28 13.8667C27.9892 10.4142 26.5107 7.10591 23.8875 4.66457C21.2644 2.22323 17.7097 0.84724 14 0.837173C11.6113 0.805461 9.25905 1.38495 7.2 2.5124L8.3 4.09457C9.08168 3.7449 9.88281 3.43423 10.7 3.16388C9.04689 6.19969 8.12546 9.53466 8 12.9361H2C2.11205 11.3994 2.59028 9.90514 3.4 8.56185L1.9 7.35196C0.655719 9.32777 -0.000131918 11.5766 1.42911e-07 13.8667C-0.000262568 15.5779 0.361679 17.2723 1.06515 18.8532C1.76862 20.4342 2.79985 21.8706 4.09992 23.0806C5.39999 24.2906 6.94344 25.2503 8.64212 25.905C10.3408 26.5597 12.1614 26.8966 14 26.8963C15.7827 26.9119 17.5507 26.5955 19.2 25.9656L18.6 24.1973C16.9605 24.8498 15.1798 25.1367 13.4 25.035C11.2675 21.9824 10.0902 18.4375 10 14.7974H27.9C27.9827 14.4935 28.0164 14.1799 28 13.8667ZM10.8 24.6627C8.81146 24.108 6.99427 23.1188 5.5 21.7776C3.51585 19.888 2.28155 17.4264 2 14.7974H8C8.1376 18.2381 9.09392 21.6076 10.8 24.6627ZM10 12.9361C10.0795 9.30781 11.2204 5.76838 13.3 2.69854H14.7C16.7796 5.76838 17.9205 9.30781 18 12.9361H10ZM20 12.9361C19.9239 9.48707 18.964 6.10485 17.2 3.07081C19.5529 3.70198 21.6444 4.9831 23.1979 6.74466C24.7514 8.50623 25.6937 10.6652 25.9 12.9361H20Z" fill="currentColor" />
                </>
            ),
            link: "/profile/account",
        },
        {
            id: "4",
            title: "Security",
            icon: (
                <>
                    <path d="M9 17.6995H7V15.8381C7.00079 15.0979 7.31712 14.3881 7.87956 13.8647C8.44199 13.3412 9.20459 13.0468 10 13.0461H16V14.9074H10C9.73486 14.9077 9.48066 15.0058 9.29319 15.1803C9.10571 15.3548 9.00026 15.5914 9 15.8381V17.6995ZM13 12.1154C12.2089 12.1154 11.4355 11.8971 10.7777 11.488C10.1199 11.0789 9.60723 10.4975 9.30448 9.81729C9.00173 9.13705 8.92252 8.38853 9.07686 7.66639C9.2312 6.94425 9.61216 6.28092 10.1716 5.76029C10.731 5.23965 11.4437 4.8851 12.2196 4.74145C12.9956 4.59781 13.7998 4.67153 14.5307 4.9533C15.2616 5.23506 15.8864 5.71222 16.3259 6.32442C16.7654 6.93662 17 7.65637 17 8.39266C16.9987 9.37961 16.5768 10.3258 15.827 11.0237C15.0771 11.7216 14.0605 12.1142 13 12.1154ZM13 6.53129C12.6044 6.53129 12.2178 6.64046 11.8889 6.84499C11.56 7.04952 11.3036 7.34022 11.1522 7.68034C11.0009 8.02047 10.9613 8.39472 11.0384 8.75579C11.1156 9.11686 11.3061 9.44853 11.5858 9.70885C11.8655 9.96916 12.2219 10.1464 12.6098 10.2183C12.9978 10.2901 13.3999 10.2532 13.7654 10.1123C14.1308 9.97146 14.4432 9.73288 14.6629 9.42678C14.8827 9.12068 15 8.7608 15 8.39266C14.9995 7.89915 14.7886 7.42599 14.4136 7.07702C14.0387 6.72805 13.5303 6.53178 13 6.53129ZM22 18.6302C21.2089 18.6302 20.4355 18.4118 19.7777 18.0028C19.1199 17.5937 18.6072 17.0123 18.3045 16.3321C18.0017 15.6518 17.9225 14.9033 18.0769 14.1812C18.2312 13.459 18.6122 12.7957 19.1716 12.2751C19.731 11.7544 20.4437 11.3999 21.2196 11.2562C21.9956 11.1126 22.7998 11.1863 23.5307 11.4681C24.2616 11.7499 24.8864 12.227 25.3259 12.8392C25.7654 13.4514 26 14.1712 26 14.9074C25.9987 15.8944 25.5768 16.8406 24.827 17.5385C24.0771 18.2363 23.0605 18.629 22 18.6302ZM22 13.0461C21.6044 13.0461 21.2178 13.1552 20.8889 13.3598C20.56 13.5643 20.3036 13.855 20.1522 14.1951C20.0009 14.5353 19.9613 14.9095 20.0384 15.2706C20.1156 15.6317 20.3061 15.9633 20.5858 16.2236C20.8655 16.4839 21.2219 16.6612 21.6098 16.733C21.9978 16.8049 22.3999 16.768 22.7654 16.6271C23.1308 16.4862 23.4432 16.2477 23.6629 15.9416C23.8827 15.6355 24 15.2756 24 14.9074C23.9995 14.4139 23.7886 13.9408 23.4136 13.5918C23.0387 13.2428 22.5303 13.0466 22 13.0461ZM28 24.2143H26V22.3529C25.9997 22.1062 25.8943 21.8696 25.7068 21.6951C25.5193 21.5206 25.2651 21.4225 25 21.4222H19C18.7349 21.4225 18.4807 21.5206 18.2932 21.6951C18.1057 21.8696 18.0003 22.1062 18 22.3529V24.2143H16V22.3529C16.0008 21.6126 16.3171 20.9029 16.8796 20.3795C17.442 19.856 18.2046 19.5616 19 19.5609H25C25.7954 19.5616 26.558 19.856 27.1204 20.3795C27.6829 20.9029 27.9992 21.6126 28 22.3529V24.2143Z" fill="currentColor" />
                    <path d="M12 23.9649L6.76601 21.3683C5.32521 20.655 4.12031 19.5901 3.28066 18.2877C2.441 16.9853 1.99827 15.4947 2.00001 13.9759V1.87699H22V7.4611H24V1.87699C23.9995 1.38348 23.7886 0.910319 23.4136 0.561351C23.0387 0.212384 22.5303 0.0161178 22 0.015625H2.00001C1.46974 0.0161178 0.961336 0.212384 0.586378 0.561351C0.21142 0.910319 0.000536334 1.38348 6.85781e-06 1.87699V13.9759C-0.00222166 15.832 0.538726 17.6536 1.56478 19.2452C2.59084 20.8368 4.06327 22.1384 5.82401 23.01L12 26.0748V23.9649Z" fill="currentColor" />
                </>
            ),
            link: "/profile/security",
        }
    ]

    const drawer = (
        <Box sx={{ borderRight: "1px solid #E3E2E2" }}>
            <List sx={{ padding: "10px 20px", rowGap: { xs: "10px", sm: "20px" } }}>
                {drawerItems.map((drawerItem, index) => {
                    const isActive = router.pathname === drawerItem.link
                    return (
                        <ListItem key={`${drawerItem.id} - ${index}`} disablePadding >
                            <Link href={drawerItem.link}>
                                <ListItemButton sx={{
                                    display: "flex",
                                    alignItems: "center",
                                    padding: { xs: "10px 0", sm: "20px 0" }
                                }}  >
                                    <ListItemIcon sx={{
                                        height: "100%",
                                        display: "flex",
                                        alignItems: "center",
                                        justifyContent: "center"
                                    }}>
                                        <SvgIcon viewBox="0 0 32 32" sx={{
                                            height: "29px",
                                            width: "32px",
                                            color: isActive ? "primary.main" : "#E8E8E8",
                                        }}>
                                            {drawerItem.icon}
                                        </SvgIcon>
                                    </ListItemIcon>
                                    <ListItemText
                                        sx={{
                                            color: isActive ? "primary.main" : "#E8E8E8",
                                        }}
                                        primary={
                                            <Typography
                                                sx={
                                                    {
                                                        display: "inline-block",
                                                        padding: "5px 0",
                                                        borderRadius: "5px",
                                                        fontWeight: "bold",
                                                        letterSpacing: 2,
                                                        fontSize: { xs: "16px", sm: "18px" },
                                                        position: "relative",
                                                        "&::before": {
                                                            content: "''",
                                                            display: "inline-block",
                                                            width: "100%",
                                                            height: "5px",
                                                            backgroundColor: isActive ? "primary.main" : "#E8E8E8",
                                                            position: "absolute",
                                                            bottom: "0",
                                                            left: "0",
                                                            borderRadius: "5px",

                                                        }
                                                    }
                                                }
                                            >
                                                {drawerItem.title}
                                            </Typography>
                                        } />

                                </ListItemButton>
                            </Link>
                        </ListItem>
                    )
                }
                )}
            </List>
        </Box>
    );

    return (
        <Box>
            <CustomAppbar handleDrawerToggle={handleDrawerToggle} />
            <Drawer
                // hideBackdrop
                container={container}
                variant="temporary"
                open={mobileOpen}
                onClose={handleDrawerToggle}
                ModalProps={{
                    keepMounted: true, // Better open performance on mobile.
                }}
                sx={{
                    border: "none",
                    display: { xs: 'block', sm: 'none' },
                    '& .MuiDrawer-paper': {
                        boxSizing: 'border-box',
                        width: drawerWidth,
                        borderWidth: 0,
                        border: "none"
                    },
                }}
            >
                {drawer}
            </Drawer>

            <Drawer
                variant="permanent"
                sx={{
                    display: { xs: 'none', sm: 'block' },
                    '& .MuiPaper-root': { mt: "94px" },
                    '& .MuiDrawer-paper': {
                        boxSizing: 'border-box',
                        width: drawerWidth,
                        border: "none"
                    },
                }}
                open
            >
                {drawer}
            </Drawer>
            <Box component="main"
                sx={{
                    marginLeft: { xs: "none", sm: `${drawerWidth}px` },
                    position: "relative",
                    flexGrow: 1,
                    p: 3
                }}>
                {children}
            </Box>
        </Box>
    );
}
